import pytest
from app import app  # Assurez-vous d'importer l'application Flask

@pytest.mark.parametrize("text_input, expected_status_code", [
    ("Hello", 200),  # Un texte simple qui devrait être traduit et prédit
    ("", 400),  # Texte vide, devrait renvoyer une erreur
])
def test_predict(text_input, expected_status_code):
    client = app.test_client()

    try:
        # Simulez une requête POST vers /predict
        response = client.post("/predict", json={"text": text_input})

        # Vérifiez que le code de statut de la réponse est celui attendu
        assert response.status_code == expected_status_code

        # Si le test a réussi et qu'il y a des prédictions, assurez-vous que la réponse contient ce qui est attendu
        if response.status_code == 200:
            data = response.get_json()
            assert "original_text" in data
            assert "translated_text" in data
            assert "prediction" in data
            assert isinstance(data["prediction"], list)

    except Exception as e:
        pytest.fail(f"Une erreur est survenue pendant l'exécution du test : {e}")
